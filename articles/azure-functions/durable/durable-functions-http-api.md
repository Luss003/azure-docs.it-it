---
title: HTTP APIs in Durable Functions - Azure Functions
description: Informazioni su come implementare API HTTP nell'estensione Funzioni permanenti per Funzioni di Azure.
author: cgillum
ms.topic: conceptual
ms.date: 09/07/2019
ms.author: azfuncdf
ms.openlocfilehash: 0390211e6fc42bd7183a770cac409b880310d317
ms.sourcegitcommit: d6b68b907e5158b451239e4c09bb55eccb5fef89
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/20/2019
ms.locfileid: "74231398"
---
# <a name="http-api-reference"></a>Informazioni di riferimento sulle API HTTP

The Durable Functions extension exposes a set of built-in HTTP APIs that can be used to perform management tasks on [orchestrations](durable-functions-types-features-overview.md#orchestrator-functions), [entities](durable-functions-types-features-overview.md#entity-functions), and [task hubs](durable-functions-task-hubs.md). These HTTP APIs are extensibility webhooks that are authorized by the Azure Functions host but handled directly by the Durable Functions extension.

All HTTP APIs implemented by the extension require the following parameters. Il tipo di dati di tutti i parametri è `string`.

| Parametro        | Tipo di parametro  | Description |
|------------------|-----------------|-------------|
| **`taskHub`**    | Stringa di query    | Nome dell'[hub attività](durable-functions-task-hubs.md). Se non specificato, viene usato il nome dell'hub attività dell'app per le funzioni corrente. |
| **`connection`** | Stringa di query    | **Nome** della stringa di connessione per l'account di archiviazione. Se non specificato, viene usata la stringa di connessione predefinita dell'app per le funzioni. |
| **`systemKey`**  | Stringa di query    | Chiave di autorizzazione necessaria per richiamare l'API. |

`systemKey` is an authorization key autogenerated by the Azure Functions host. In particolare, concede l'accesso alle API dell'estensione Durable Task e può essere gestita allo stesso modo di [altre chiavi di autorizzazione](https://github.com/Azure/azure-webjobs-sdk-script/wiki/Key-management-API). You can generate URLs that contain the correct `taskHub`, `connection`, and `systemKey` query string values using [orchestration client binding](durable-functions-bindings.md#orchestration-client) APIs, such as the `CreateCheckStatusResponse` and `CreateHttpManagementPayload` APIs in .NET, or the `createCheckStatusResponse` and `createHttpManagementPayload` APIs in JavaScript.

Le prossime sezioni illustrano le specifiche API HTTP supportate dall'estensione e offrono esempi su come possono essere usate.

## <a name="start-orchestration"></a>Start orchestration

Starts executing a new instance of the specified orchestrator function.

### <a name="request"></a>Richiesta

For version 1.x of the Functions runtime, the request is formatted as follows (multiple lines are shown for clarity):

```http
POST /admin/extensions/DurableTaskExtension/orchestrators/{functionName}/{instanceId?}
     ?taskHub={taskHub}
     &connection={connectionName}
     &code={systemKey}
```

In version 2.x of the Functions runtime, the URL format has all the same parameters but with a slightly different prefix:

```http
POST /runtime/webhooks/durabletask/orchestrators/{functionName}/{instanceId?}
     ?taskHub={taskHub}
     &connection={connectionName}
     &code={systemKey}
```

I parametri della richiesta per questa API includono il set predefinito indicato in precedenza, nonché i parametri univoci seguenti:

| Campo              | Tipo di parametro  | Description |
|--------------------|-----------------|-------------|
| **`functionName`** | URL             | The name of the orchestrator function to start. |
| **`instanceId`**   | URL             | Parametro facoltativo. ID dell'istanza di orchestrazione. If not specified, the orchestrator function will start with a random instance ID. |
| **`{content}`**    | Contenuto della richiesta | facoltativo. The JSON-formatted orchestrator function input. |

### <a name="response"></a>Response

Possono essere restituiti diversi valori di codice di stato.

* **HTTP 202 (Accepted)** : The specified orchestrator function was scheduled to start running. The `Location` response header contains a URL for polling the orchestration status.
* **HTTP 400 (Bad request)** : The specified orchestrator function doesn't exist, the specified instance ID was not valid, or request content was not valid JSON.

The following is an example request that starts a `RestartVMs` orchestrator function and includes  JSON object payload:

```http
POST /runtime/webhooks/durabletask/orchestrators/RestartVMs?code=XXX
Content-Type: application/json
Content-Length: 83

{
    "resourceGroup": "myRG",
    "subscriptionId": "111deb5d-09df-4604-992e-a968345530a9"
}
```

The response payload for the **HTTP 202** cases is a JSON object with the following fields:

| Campo                       | Description                          |
|-----------------------------|--------------------------------------|
| **`id`**                    |ID dell'istanza di orchestrazione. |
| **`statusQueryGetUri`**     |URL di stato dell'istanza di orchestrazione. |
| **`sendEventPostUri`**      |URL di generazione evento dell'istanza di orchestrazione. |
| **`terminatePostUri`**      |URL di terminazione dell'istanza di orchestrazione. |
| **`purgeHistoryDeleteUri`** |The "purge history" URL of the orchestration instance. |
| **`rewindPostUri`**         |(preview) The "rewind" URL of the orchestration instance. |

Il tipo di dati di tutti i campi è `string`.

Here is an example response payload for an orchestration instance with `abc123` as its ID (formatted for readability):

```http
{
    "id": "abc123",
    "purgeHistoryDeleteUri": "http://localhost:7071/runtime/webhooks/durabletask/instances/abc123?code=XXX",
    "sendEventPostUri": "http://localhost:7071/runtime/webhooks/durabletask/instances/abc123/raiseEvent/{eventName}?code=XXX",
    "statusQueryGetUri": "http://localhost:7071/runtime/webhooks/durabletask/instances/abc123?code=XXX",
    "terminatePostUri": "http://localhost:7071/runtime/webhooks/durabletask/instances/abc123/terminate?reason={text}&code=XXX"
}
```

The http response is intended to be compatible with the *Polling Consumer Pattern*. It also includes the following notable response headers:

* **Location**: The URL of the status endpoint. This URL contains the same value as the `statusQueryGetUri` field.
* **Retry-After**: The number of seconds to wait between polling operations. Il valore predefinito è `10`.

For more information on the asynchronous HTTP polling pattern, see the [HTTP async operation tracking](durable-functions-http-features.md#async-operation-tracking) documentation.

## <a name="get-instance-status"></a>Get instance status (Ottieni stato istanza)

Ottiene lo stato di un'istanza di orchestrazione specificata.

### <a name="request"></a>Richiesta

For version 1.x of the Functions runtime, the request is formatted as follows (multiple lines are shown for clarity):

```http
GET /admin/extensions/DurableTaskExtension/instances/{instanceId}
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &showHistory=[true|false]
    &showHistoryOutput=[true|false]
    &showInput=[true|false]
```

In version 2.x of the Functions runtime, the URL format has all the same parameters but with a slightly different prefix:

```http
GET /runtime/webhooks/durabletask/instances/{instanceId}
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &showHistory=[true|false]
    &showHistoryOutput=[true|false]
    &showInput=[true|false]
```

I parametri della richiesta per questa API includono il set predefinito indicato in precedenza, nonché i parametri univoci seguenti:

| Campo                   | Tipo di parametro  | Description |
|-------------------------|-----------------|-------------|
| **`instanceId`**        | URL             | ID dell'istanza di orchestrazione. |
| **`showInput`**         | Stringa di query    | Parametro facoltativo. If set to `false`, the function input will not be included in the response payload.|
| **`showHistory`**       | Stringa di query    | Parametro facoltativo. Se impostato su `true`, la cronologia di esecuzione dell'orchestrazione verrà inclusa nel payload della risposta.|
| **`showHistoryOutput`** | Stringa di query    | Parametro facoltativo. If set to `true`, the function outputs will be included in the orchestration execution history.|
| **`createdTimeFrom`**   | Stringa di query    | Parametro facoltativo. When specified, filters the list of returned instances that were created at or after the given ISO8601 timestamp.|
| **`createdTimeTo`**     | Stringa di query    | Parametro facoltativo. When specified, filters the list of returned instances that were created at or before the given ISO8601 timestamp.|
| **`runtimeStatus`**     | Stringa di query    | Parametro facoltativo. Se specificato, filtra l'elenco delle istanze restituite in base allo stato del runtime. To see the list of possible runtime status values, see the [Querying instances](durable-functions-instance-management.md) article. |

### <a name="response"></a>Response

Possono essere restituiti diversi valori di codice di stato.

* **HTTP 200 (OK)** : l'istanza specificata è in stato completato.
* **HTTP 202 (Accettata )** : l'istanza specificata è in esecuzione.
* **HTTP 400 (Richiesta non valida)** : l'istanza specificata ha avuto esito negativo o è stata terminata.
* **HTTP 404 (Non trovata)** : l'istanza specificata non esiste o l'esecuzione non è iniziata.
* **HTTP 500 (Errore interno del server)** : si è verificato un errore dell'istanza specificata con un'eccezione non gestita.

Il payload di risposta per i casi **HTTP 200** e **HTTP 202** è un oggetto JSON con i campi seguenti:

| Campo                 | Tipo di dati | Description |
|-----------------------|-----------|-------------|
| **`runtimeStatus`**   | string    | Stato di runtime dell'istanza. I valori includono *In esecuzione*, *In sospeso*, *Non riuscito*, *Annullato*, *Terminato*, *Completato*. |
| **`input`**           | JSON      | Dati JSON usati per inizializzare l'istanza. Questo campo è `null` quando il parametro della stringa di query `showInput` è impostato su `false`.|
| **`customStatus`**    | JSON      | I dati JSON usati per lo stato dell'orchestrazione personalizzato. Se non impostato, il campo è `null`. |
| **`output`**          | JSON      | Output JSON dell'istanza. Questo campo è `null` se l'istanza non è in stato completato. |
| **`createdTime`**     | string    | Data e ora di creazione dell'istanza. Usa la notazione estesa ISO 8601. |
| **`lastUpdatedTime`** | string    | Data e ora dell'ultimo stato persistente dell'istanza. Usa la notazione estesa ISO 8601. |
| **`historyEvents`**   | JSON      | Matrice JSON contenente la cronologia di esecuzione dell'orchestrazione. Questo campo è `null` a meno che il parametro della stringa di query `showHistory` non sia impostato su `true`. |

Ecco un payload di risposta di esempio che include la cronologia di esecuzione dell'orchestrazione e gli output delle attività (formattato per migliorarne la leggibilità):

```json
{
  "createdTime": "2018-02-28T05:18:49Z",
  "historyEvents": [
      {
          "EventType": "ExecutionStarted",
          "FunctionName": "E1_HelloSequence",
          "Timestamp": "2018-02-28T05:18:49.3452372Z"
      },
      {
          "EventType": "TaskCompleted",
          "FunctionName": "E1_SayHello",
          "Result": "Hello Tokyo!",
          "ScheduledTime": "2018-02-28T05:18:51.3939873Z",
          "Timestamp": "2018-02-28T05:18:52.2895622Z"
      },
      {
          "EventType": "TaskCompleted",
          "FunctionName": "E1_SayHello",
          "Result": "Hello Seattle!",
          "ScheduledTime": "2018-02-28T05:18:52.8755705Z",
          "Timestamp": "2018-02-28T05:18:53.1765771Z"
      },
      {
          "EventType": "TaskCompleted",
          "FunctionName": "E1_SayHello",
          "Result": "Hello London!",
          "ScheduledTime": "2018-02-28T05:18:53.5170791Z",
          "Timestamp": "2018-02-28T05:18:53.891081Z"
      },
      {
          "EventType": "ExecutionCompleted",
          "OrchestrationStatus": "Completed",
          "Result": [
              "Hello Tokyo!",
              "Hello Seattle!",
              "Hello London!"
          ],
          "Timestamp": "2018-02-28T05:18:54.3660895Z"
      }
  ],
  "input": null,
  "customStatus": { "nextActions": ["A", "B", "C"], "foo": 2 },
  "lastUpdatedTime": "2018-02-28T05:18:54Z",
  "output": [
      "Hello Tokyo!",
      "Hello Seattle!",
      "Hello London!"
  ],
  "runtimeStatus": "Completed"
}
```

La risposta **HTTP 202** include anche un'intestazione di risposta **Location** che referenzia lo stesso URL del campo `statusQueryGetUri` citato in precedenza.

## <a name="get-all-instances-status"></a>Ottenere lo stato di tutte le istanze

You can also query the status of all instances by removing the `instanceId` from the 'Get instance status' request. In this case, the basic parameters are the same as the 'Get instance status'. Query string parameters for filtering are also supported.

Tenere presente che `connection` e `code` sono facoltativi. If you have anonymous auth on the function, then `code` isn't required.
If you don't want to use a different storage connection string other than defined in the AzureWebJobsStorage app setting, then you can safely ignore the connection query string parameter.

### <a name="request"></a>Richiesta

For version 1.x of the Functions runtime, the request is formatted as follows (multiple lines are shown for clarity):

```http
GET /admin/extensions/DurableTaskExtension/instances
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &createdTimeFrom={timestamp}
    &createdTimeTo={timestamp}
    &runtimeStatus={runtimeStatus1,runtimeStatus2,...}
    &showInput=[true|false]
    &top={integer}
```

In version 2.x of the Functions runtime, the URL format has all the same parameters but with a slightly different prefix:

```http
GET /runtime/webhooks/durableTask/instances?
    taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &createdTimeFrom={timestamp}
    &createdTimeTo={timestamp}
    &runtimeStatus={runtimeStatus1,runtimeStatus2,...}
    &showInput=[true|false]
    &top={integer}
```

I parametri della richiesta per questa API includono il set predefinito indicato in precedenza, nonché i parametri univoci seguenti:

| Campo                   | Tipo di parametro  | Description |
|-------------------------|-----------------|-------------|
| **`instanceId`**        | URL             | ID dell'istanza di orchestrazione. |
| **`showInput`**         | Stringa di query    | Parametro facoltativo. If set to `false`, the function input will not be included in the response payload.|
| **`showHistory`**       | Stringa di query    | Parametro facoltativo. Se impostato su `true`, la cronologia di esecuzione dell'orchestrazione verrà inclusa nel payload della risposta.|
| **`showHistoryOutput`** | Stringa di query    | Parametro facoltativo. If set to `true`, the function outputs will be included in the orchestration execution history.|
| **`createdTimeFrom`**   | Stringa di query    | Parametro facoltativo. When specified, filters the list of returned instances that were created at or after the given ISO8601 timestamp.|
| **`createdTimeTo`**     | Stringa di query    | Parametro facoltativo. When specified, filters the list of returned instances that were created at or before the given ISO8601 timestamp.|
| **`runtimeStatus`**     | Stringa di query    | Parametro facoltativo. Se specificato, filtra l'elenco delle istanze restituite in base allo stato del runtime. To see the list of possible runtime status values, see the [Querying instances](durable-functions-instance-management.md) article. |
| **`top`**               | Stringa di query    | Parametro facoltativo. When specified, limits the number of instances returned by the query. |

### <a name="response"></a>Response

Di seguito è riportato un esempio di payload di risposta, compreso lo stato dell'orchestrazione (formattato per migliorare la leggibilità):

```json
[
    {
        "instanceId": "7af46ff000564c65aafbfe99d07c32a5",
        "runtimeStatus": "Completed",
        "input": null,
        "customStatus": null,
        "output": [
            "Hello Tokyo!",
            "Hello Seattle!",
            "Hello London!"
        ],
        "createdTime": "2018-06-04T10:46:39Z",
        "lastUpdatedTime": "2018-06-04T10:46:47Z"
    },
    {
        "instanceId": "80eb7dd5c22f4eeba9f42b062794321e",
        "runtimeStatus": "Running",
        "input": null,
        "customStatus": null,
        "output": null,
        "createdTime": "2018-06-04T15:18:28Z",
        "lastUpdatedTime": "2018-06-04T15:18:38Z"
    },
    {
        "instanceId": "9124518926db408ab8dfe84822aba2b1",
        "runtimeStatus": "Completed",
        "input": null,
        "customStatus": null,
        "output": [
            "Hello Tokyo!",
            "Hello Seattle!",
            "Hello London!"
        ],
        "createdTime": "2018-06-04T10:46:54Z",
        "lastUpdatedTime": "2018-06-04T10:47:03Z"
    },
    {
        "instanceId": "d100b90b903c4009ba1a90868331b11b",
        "runtimeStatus": "Pending",
        "input": null,
        "customStatus": null,
        "output": null,
        "createdTime": "2018-06-04T15:18:39Z",
        "lastUpdatedTime": "2018-06-04T15:18:39Z"
    }
]
```

> [!NOTE]
> Questa operazione può risultare molto costosa in termini di Archiviazione di Azure I/O se sono presenti molte righe nella tabella delle istanze. Altre informazioni sulla tabella di istanza sono reperibili nella documentazione [Prestazioni e scalabilità in Funzioni permanenti (Funzioni di Azure)](durable-functions-perf-and-scale.md#instances-table).
>

If more results exist, a continuation token is returned in the response header.  Il nome dell’intestazione è `x-ms-continuation-token`.

If you set continuation token value in the next request header, you can get the next page of results. This name of the request header is also `x-ms-continuation-token`.

## <a name="purge-single-instance-history"></a>Purge single instance history

Deletes the history and related artifacts for a specified orchestration instance.

### <a name="request"></a>Richiesta

For version 1.x of the Functions runtime, the request is formatted as follows (multiple lines are shown for clarity):

```http
DELETE /admin/extensions/DurableTaskExtension/instances/{instanceId}
    ?taskHub={taskHub}
    &connection={connection}
    &code={systemKey}
```

In version 2.x of the Functions runtime, the URL format has all the same parameters but with a slightly different prefix:

```http
DELETE /runtime/webhooks/durabletask/instances/{instanceId}
    ?taskHub={taskHub}
    &connection={connection}
    &code={systemKey}
```

I parametri della richiesta per questa API includono il set predefinito indicato in precedenza, nonché i parametri univoci seguenti:

| Campo             | Tipo di parametro  | Description |
|-------------------|-----------------|-------------|
| **`instanceId`**  | URL             | ID dell'istanza di orchestrazione. |

### <a name="response"></a>Response

The following HTTP status code values can be returned.

* **HTTP 200 (OK)** : The instance history has been purged successfully.
* **HTTP 404 (Not Found)** : The specified instance doesn't exist.

The response payload for the **HTTP 200** case is a JSON object with the following field:

| Campo                  | Tipo di dati | Description |
|------------------------|-----------|-------------|
| **`instancesDeleted`** | integer   | The number of instances deleted. For the single instance case, this value should always be `1`. |

Di seguito è riportato un payload di risposta di esempio (formattato per migliorare la leggibilità):

```json
{
    "instancesDeleted": 1
}
```

## <a name="purge-multiple-instance-histories"></a>Purge multiple instance histories

You can also delete the history and related artifacts for multiple instances within a task hub by removing the `{instanceId}` from the 'Purge single instance history' request. To selectively purge instance history, use the same filters described in the 'Get all instances status' request.

### <a name="request"></a>Richiesta

For version 1.x of the Functions runtime, the request is formatted as follows (multiple lines are shown for clarity):

```http
DELETE /admin/extensions/DurableTaskExtension/instances
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &createdTimeFrom={timestamp}
    &createdTimeTo={timestamp}
    &runtimeStatus={runtimeStatus1,runtimeStatus2,...}
```

In version 2.x of the Functions runtime, the URL format has all the same parameters but with a slightly different prefix:

```http
DELETE /runtime/webhooks/durabletask/instances
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &createdTimeFrom={timestamp}
    &createdTimeTo={timestamp}
    &runtimeStatus={runtimeStatus1,runtimeStatus2,...}
```

I parametri della richiesta per questa API includono il set predefinito indicato in precedenza, nonché i parametri univoci seguenti:

| Campo                 | Tipo di parametro  | Description |
|-----------------------|-----------------|-------------|
| **`createdTimeFrom`** | Stringa di query    | Filters the list of purged instances that were created at or after the given ISO8601 timestamp.|
| **`createdTimeTo`**   | Stringa di query    | Parametro facoltativo. When specified, filters the list of purged instances that were created at or before the given ISO8601 timestamp.|
| **`runtimeStatus`**   | Stringa di query    | Parametro facoltativo. When specified, filters the list of purged instances based on their runtime status. To see the list of possible runtime status values, see the [Querying instances](durable-functions-instance-management.md) article. |

> [!NOTE]
> This operation can be very expensive in terms of Azure Storage I/O if there are a lot of rows in the Instances and/or History tables. More details on these tables can be found in the [Performance and scale in Durable Functions (Azure Functions)](durable-functions-perf-and-scale.md#instances-table) documentation.

### <a name="response"></a>Response

The following HTTP status code values can be returned.

* **HTTP 200 (OK)** : The instance history has been purged successfully.
* **HTTP 404 (Not Found)** : No instances were found that match the filter expression.

The response payload for the **HTTP 200** case is a JSON object with the following field:

| Campo                   | Tipo di dati | Description |
|-------------------------|-----------|-------------|
| **`instancesDeleted`**  | integer   | The number of instances deleted. |

Di seguito è riportato un payload di risposta di esempio (formattato per migliorare la leggibilità):

```json
{
    "instancesDeleted": 250
}
```

## <a name="raise-event"></a>Raise event (Genera evento)

Invia un messaggio di notifica evento per un'istanza di orchestrazione in esecuzione.

### <a name="request"></a>Richiesta

For version 1.x of the Functions runtime, the request is formatted as follows (multiple lines are shown for clarity):

```http
POST /admin/extensions/DurableTaskExtension/instances/{instanceId}/raiseEvent/{eventName}
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
```

In version 2.x of the Functions runtime, the URL format has all the same parameters but with a slightly different prefix:

```http
POST /runtime/webhooks/durabletask/instances/{instanceId}/raiseEvent/{eventName}
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
```

I parametri della richiesta per questa API includono il set predefinito indicato in precedenza, nonché i parametri univoci seguenti:

| Campo             | Tipo di parametro  | Description |
|-------------------|-----------------|-------------|
| **`instanceId`**  | URL             | ID dell'istanza di orchestrazione. |
| **`eventName`**   | URL             | Nome dell'evento atteso dall'istanza di orchestrazione di destinazione. |
| **`{content}`**   | Contenuto della richiesta | Payload dell'evento in formato JSON. |

### <a name="response"></a>Response

Possono essere restituiti diversi valori di codice di stato.

* **HTTP 202 (Accettata)** : l'evento generato è stato accettato per l'elaborazione.
* **HTTP 400 (Richiesta non valida)** : il contenuto della richiesta non è di tipo `application/json` o non è un oggetto JSON valido.
* **HTTP 404 (Non trovata)** : l'istanza specificata non è stata trovata.
* **HTTP 410 (Non disponibile)** : l'istanza specificata è stata completata o ha avuto esito negativo e non può elaborare gli eventi generati.

Ecco una richiesta di esempio che invia la stringa JSON `"incr"` a un'istanza in attesa di un evento denominato **operation**:

```http
POST /admin/extensions/DurableTaskExtension/instances/bcf6fb5067b046fbb021b52ba7deae5a/raiseEvent/operation?taskHub=DurableFunctionsHub&connection=Storage&code=XXX
Content-Type: application/json
Content-Length: 6

"incr"
```

Nelle risposte per questa API non è presente contenuto.

## <a name="terminate-instance"></a>Arresta istanza

Termina un'istanza di orchestrazione in esecuzione.

### <a name="request"></a>Richiesta

For version 1.x of the Functions runtime, the request is formatted as follows (multiple lines are shown for clarity):

```http
POST /admin/extensions/DurableTaskExtension/instances/{instanceId}/terminate
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &reason={text}
```

In version 2.x of the Functions runtime, the URL format has all the same parameters but with a slightly different prefix:

```http
POST /runtime/webhooks/durabletask/instances/{instanceId}/terminate
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &reason={text}
```

I parametri della richiesta per questa API includono il set predefinito indicato in precedenza, nonché i parametri univoci seguenti.

| Campo             | Tipo di parametro  | Description |
|-------------------|-----------------|-------------|
| **`instanceId`**  | URL             | ID dell'istanza di orchestrazione. |
| **`reason`**      | Stringa di query    | facoltativo. Motivo dell'interruzione dell'istanza di orchestrazione. |

### <a name="response"></a>Response

Possono essere restituiti diversi valori di codice di stato.

* **HTTP 202 (Accettata)** : la richiesta di interruzione è stata accettata per l'elaborazione.
* **HTTP 404 (Non trovata)** : l'istanza specificata non è stata trovata.
* **HTTP 410 (Non disponibile)** : l'istanza specificata è stata completata o ha avuto esito negativo.

Ecco un esempio di richiesta che termina un'istanza in esecuzione e specifica il motivo **buggy** (con errori):

```
POST /admin/extensions/DurableTaskExtension/instances/bcf6fb5067b046fbb021b52ba7deae5a/terminate?reason=buggy&taskHub=DurableFunctionsHub&connection=Storage&code=XXX
```

Nelle risposte per questa API non è presente contenuto.

## <a name="rewind-instance-preview"></a>Ripristinare un'istanza (anteprima)

Ripristina lo stato in corso di esecuzione di un'istanza di orchestrazione non riuscita riproducendo le operazioni non riuscite più recenti.

### <a name="request"></a>Richiesta

For version 1.x of the Functions runtime, the request is formatted as follows (multiple lines are shown for clarity):

```http
POST /admin/extensions/DurableTaskExtension/instances/{instanceId}/rewind
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &reason={text}
```

In version 2.x of the Functions runtime, the URL format has all the same parameters but with a slightly different prefix:

```http
POST /runtime/webhooks/durabletask/instances/{instanceId}/rewind
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &reason={text}
```

I parametri della richiesta per questa API includono il set predefinito indicato in precedenza, nonché i parametri univoci seguenti.

| Campo             | Tipo di parametro  | Description |
|-------------------|-----------------|-------------|
| **`instanceId`**  | URL             | ID dell'istanza di orchestrazione. |
| **`reason`**      | Stringa di query    | facoltativo. Motivo del ripristino dell'istanza di orchestrazione. |

### <a name="response"></a>Response

Possono essere restituiti diversi valori di codice di stato.

* **HTTP 202 (Accettata)** : la richiesta di ripristino è stata accettata per l'elaborazione.
* **HTTP 404 (Non trovata)** : l'istanza specificata non è stata trovata.
* **HTTP 410 (Non disponibile)** : l'istanza specificata è stata completata o terminata.

Di seguito è riportato un esempio di richiesta che ripristina un'istanza non riuscita e specifica il motivo **fixed** (corretto):

```http
POST /admin/extensions/DurableTaskExtension/instances/bcf6fb5067b046fbb021b52ba7deae5a/rewind?reason=fixed&taskHub=DurableFunctionsHub&connection=Storage&code=XXX
```

Nelle risposte per questa API non è presente contenuto.

## <a name="signal-entity"></a>Signal entity

Sends a one-way operation message to a [Durable Entity](durable-functions-types-features-overview.md#entity-functions). If the entity doesn't exist, it will be created automatically.

> [!NOTE]
> Durable entities are available starting in Durable Functions 2.0.

### <a name="request"></a>Richiesta

The HTTP request is formatted as follows (multiple lines are shown for clarity):

```http
POST /runtime/webhooks/durabletask/entities/{entityType}/{entityKey}
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
    &op={operationName}
```

I parametri della richiesta per questa API includono il set predefinito indicato in precedenza, nonché i parametri univoci seguenti:

| Campo             | Tipo di parametro  | Description |
|-------------------|-----------------|-------------|
| **`entityType`**  | URL             | The type of the entity. |
| **`entityKey`**   | URL             | The unique name of the entity. |
| **`op`**          | Stringa di query    | facoltativo. The name of the user-defined operation to invoke. |
| **`{content}`**   | Contenuto della richiesta | Payload dell'evento in formato JSON. |

Here is an example request that sends a user-defined "Add" message to a `Counter` entity named `steps`. The content of the message is the value `5`. If the entity does not already exist, it will be created by this request:

```http
POST /runtime/webhooks/durabletask/entities/Counter/steps?op=Add
Content-Type: application/json

5
```

### <a name="response"></a>Response

This operation has several possible responses:

* **HTTP 202 (Accepted)** : The signal operation was accepted for asynchronous processing.
* **HTTP 400 (Bad request)** : The request content was not of type `application/json`, was not valid JSON, or had an invalid `entityKey` value.
* **HTTP 404 (Not Found)** : The specified `entityType` was not found.

A successful HTTP request does not contain any content in the response. A failed HTTP request may contain JSON-formatted error information in the response content.

## <a name="query-entity"></a>Query entity

Gets the state of the specified entity.

### <a name="request"></a>Richiesta

The HTTP request is formatted as follows (multiple lines are shown for clarity):

```http
GET /runtime/webhooks/durabletask/entities/{entityType}/{entityKey}
    ?taskHub={taskHub}
    &connection={connectionName}
    &code={systemKey}
```

### <a name="response"></a>Response

This operation has two possible responses:

* **HTTP 200 (OK)** : The specified entity exists.
* **HTTP 404 (Not Found)** : The specified entity was not found.

A successful response contains the JSON-serialized state of the entity as its content.

### <a name="example"></a>Esempio
The following example HTTP request gets the state of an existing `Counter` entity named `steps`:

```http
GET /runtime/webhooks/durabletask/entities/Counter/steps
```

If the `Counter` entity simply contained a number of steps saved in a `currentValue` field, the response content might look like the following (formatted for readability):

```json
{
    "currentValue": 5
}
```

## <a name="next-steps"></a>Passaggi successivi

> [!div class="nextstepaction"]
> [Learn how to use Application Insights to monitor your durable functions](durable-functions-diagnostics.md)